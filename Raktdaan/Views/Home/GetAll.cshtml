<link rel="stylesheet" href="https://cdn.datatables.net/2.0.7/css/dataTables.dataTables.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/rowreorder/1.5.0/css/rowReorder.dataTables.css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css">



<div class="container p-3 ">
    <div class="row pt-4">
        <div class="col-6">
          </div>
        <div class="col-6 text-end">
         </div>
    </div>
    <br /><br />

 
    <table id="myTable" class="table nowrap dataTable  no-footer dtr-inlinep">
       
        <thead >
            <tr >
                <th >Name</th>
                <th>Blood Group</th>
                <th>City</th>
                <th>State</th>
                <th>Country</th>
                <th>Status</th>
            </tr>
            <tr class="filters">
                <th><input type="text" placeholder="Search Name" class="column-search" data-column="0" /></th>
                <!-- Other search inputs -->
                <th>
                    <select class="form-select column-search" data-column="1" aria-label="Blood Group">
                        <option value="">All Blood Groups</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                </th>
                <th><input type="text" placeholder="Search City" class="column-search" data-column="2" /></th>
                <th><input type="text" placeholder="Search State" class="column-search" data-column="3" /></th>
                <th><input type="text" placeholder="Search Country" class="column-search" data-column="4" /></th>
                <th></th>
            </tr>
        </thead>
    </table>
</div>


@section Scripts {
    <script src="//cdn.datatables.net/2.0.7/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>

    <script src="~/js/user.js"></script>



    <script>
        $(document).ready(function () {
            loadDataTable();

            function loadDataTable() {
                $('#myTable').DataTable({
                    "ajax": {
                        "url": "/Home/GetAll"
                    },
                    "columns": [
                        { "data": "full_Name" },
                        { "data": "blood_group" },
                        { "data": "city" },
                        { "data": "state" },
                        { "data": "country" },
                        {
                            "data": "id",
                            "render": function (data) {
                                return `
                                            <button class="stripe-buy-button btn btn-danger btn-sm" data-id="${data}">Pay Now</button>
                                        `;
                            }
                        }
                    ],
                    "paging": false
                });
            }

            // Handle click event for the Stripe buy button
            $(document).on('click', '.stripe-buy-button', function (e) {
                e.preventDefault();
                var donorId = $(this).data('id');

                // Create a Checkout Session with the selected price
                $.ajax({
                    url: '/Payment/CreateCheckoutSession',
                    method: 'POST',
                    data: { donorId: donorId },
                    success: function (sessionId) {
                        var stripe = Stripe('pk_test_51PHdjuSE21W6ukJqMCcDKgj1aCjwbuhtMeF8F3cxlCLx9FDIuNl8Zuk0wFbVm3Q4nvq1fMQIv9zPtkOUwgphEN8z00rzu2NonH');
                        stripe.redirectToCheckout({ sessionId: sessionId });
                    },
                    error: function (error) {
                        console.error("Error creating Stripe Checkout session:", error);
                    }
                });
            });
        });</script>
}